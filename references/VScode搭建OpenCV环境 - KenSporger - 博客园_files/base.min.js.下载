function Base(){const bndongJs=this,tools=new myTools,progressBar=new ToProgress(window.cnblogsConfig.progressBar,'#bottomProgressBar');var temScroll=0,timeIds={setMenuIntroduceTId:null,setMenuCalendarTId:null,setSidebarSearchTId:null,setSidebarScorerankTId:null,setMenuSidebarTId:null,setMenuToptagsTId:null,setMenuClassifyTId:null,setMenuRecordTId:null,setMenuArticleTId:null,setMenuTopviewTId:null,setMenuTopDiggPostsTId:null,setMenuRecentCommentsTId:null,setHomeRightMenuTId:null,setNotHomeRightMenuTId:null,setCnzzTId:null,setAmazingTId:null,setCatalogTId:null,blogPostCategoryTId:null,entryTagTId:null,commentTId:null,};this.init=function(){bndongJs.loadingBeforeInit();bndongJs.endLoading();bndongJs.loadingAfterInit()};this.loadingBeforeInit=function(){setTimeout(bndongJs.clearIntervalAll,30000);if(window.cnblogsConfig.fontIconExtend!=='')tools.dynamicLoadingCss(window.cnblogsConfig.fontIconExtend);($('#topics').length>0)?bndongJs.notHomeInit():bndongJs.homeInit()};this.loadingAfterInit=function(){bndongJs.addFooter();if(window.cnblogsConfig.bgAnimationRendered)require(['RibbonsEffect']);let linkObject=document.createElement('link');linkObject.rel="shortcut icon";linkObject.href=window.cnblogsConfig.webpageIcon;document.getElementsByTagName("head")[0].appendChild(linkObject);$(window).scroll(function(){bndongJs.scrollMonitor()});$(window).resize(function(){bndongJs.resizeMonitor()});$('#homeTopTitle').text(window.cnblogsConfig.blogUser);$('#menuWrap').optiscroll({forceScrollbars:true,maxTrackSize:20,preventParentScroll:true});var blogAvatar=window.cnblogsConfig.blogAvatar?window.cnblogsConfig.blogAvatar:'https://images.cnblogs.com/cnblogs_com/kensporger/1639798/o_200131101838default_avatar.jpeg';$('#menuBlogAvatar').append("<img src='"+blogAvatar+"'>");bndongJs.htmlTitle();bndongJs.setMenuUserInfoImg();let setMenuData=bndongJs.setMenuData();timeIds.setMenuIntroduceTId=window.setInterval(setMenuData.setIntroduce,1000);timeIds.setMenuCalendarTId=window.setInterval(setMenuData.setCalendar,1000);timeIds.setSidebarSearchTId=window.setInterval(setMenuData.setSidebarSearch,1000);timeIds.setSidebarScorerankTId=window.setInterval(setMenuData.setSidebarScorerank,1000);timeIds.setMenuSidebarTId=window.setInterval(setMenuData.setSidebar,1000);timeIds.setMenuToptagsTId=window.setInterval(setMenuData.setToptags,1000);timeIds.setMenuClassifyTId=window.setInterval(setMenuData.setClassify,1000);timeIds.setMenuArticleTId=window.setInterval(setMenuData.setArticle,1000);timeIds.setMenuRecordTId=window.setInterval(setMenuData.setRecord,1000);timeIds.setMenuTopviewTId=window.setInterval(setMenuData.setTopview,1000);timeIds.setMenuTopDiggPostsTId=window.setInterval(setMenuData.setTopDiggPosts,1000);timeIds.setMenuRecentCommentsTId=window.setInterval(setMenuData.setRecentComments,1000);setMenuData.setCustomData();$('.m-list-title-select').click(function(){$(this).parents('.m-list-title').next('.m-icon-list').slideToggle(500)});bndongJs.setPageAnimationControl();tools.consoleText(window.cnblogsConfig.consoleList,'banner')};this.clearIntervalAll=function(){$.each(timeIds,function(e){null!=e&&window.clearInterval(e)})};this.clearIntervalTimeId=function(timeId){null!=timeId&&window.clearInterval(timeId)};this.scrollMonitor=function(){var homeScroll=$('#home').offset().top-40,docScroll=$(document).scrollTop(),openButton=$('#open-button'),sideToolbar=$('#sideToolbar'),sideToolbarTop=$('.main-header').outerHeight(),scrollPercent=tools.getScrollPercent(),toUpDown=$("#toUpDown"),toUpDownI=$("#toUpDownI"),toUpDownSpan=$('.toUpDownSpan');progressBar.setProgress(scrollPercent);if(sideToolbarTop<=docScroll){if(!sideToolbar.hasClass('sideToolbarFix')){sideToolbar.addClass('sideToolbarFix')}}else{sideToolbar.removeClass('sideToolbarFix')}if(homeScroll<=docScroll){toUpDownI.rotate({animateTo:0});toUpDown.attr('data','up');toUpDownSpan.text('返回顶部')}else{toUpDownI.rotate({animateTo:-180});toUpDown.attr('data','down');toUpDownSpan.text('跳至底部')}if(temScroll<docScroll){if(homeScroll<=docScroll){if(!openButton.hasClass('menu-button-scroll')){openButton.addClass('menu-button-scroll');openButton.text('')}}}else{if(homeScroll>=docScroll){if(openButton.hasClass('menu-button-scroll')){openButton.removeClass('menu-button-scroll');openButton.text('MENU')}}}temScroll=docScroll};this.resizeMonitor=function(){var bodyWidth=parseFloat(document.body.clientWidth);bndongJs.setDomHomePosition();if($('#sideToolbar').length>0){var mainContentWidth=$('#mainContent').outerWidth(true);var listWidth=$('#sideCatalog').outerWidth(true);listWidth=listWidth>220?listWidth:242;var bothWidth=(bodyWidth-mainContentWidth)/2;var rightPx=bothWidth-listWidth-50;$('#sideCatalog').css('right',(rightPx>0?rightPx:0)+'px');if(bodyWidth>1360){$('#sideToolbar').css('visibility','visible')}else{$('#sideToolbar').css('visibility','hidden')}}};this.rightMenuMous=function(parentObject,subObject){$(parentObject).on({mouseover:function(){var str='';if(subObject==='.rightBuryitSpan'){str=$('#bury_count').text();if($(subObject).text()!==str){$(parentObject).attr('clickflg','false');$(subObject).text(str)}}if(subObject==='.rightDiggitSpan'){str=$('#digg_count').text();if($(subObject).text()!==str){$(parentObject).attr('clickflg','false');$(subObject).text(str)}}$(subObject).show()},mouseout:function(){$(subObject).hide()},click:function(){if(subObject==='.rightBuryitSpan'||subObject==='.rightDiggitSpan'){if($(this).attr('clickflg')==='false'){$(this).attr('clickflg','true');$(subObject).text('提交中..');setTimeout("$('"+subObject+"').text($('#digg_tips').text())",1500)}}if(subObject==='.attentionSpan'){if($(this).attr('clickflg')==='false'){setTimeout(hanFollow,1500);function hanFollow(){if('关注成功'===$.trim($('#p_b_follow').text())){$(parentObject).attr('clickflg','true');$(subObject).text('已关注');$(parentObject).find('i').removeClass('icon-dianzan').addClass('icon-dianzan1')}}}}if(subObject==='.toUpDownSpan'){var ac=$(this).attr('data');if(ac==='down'){var docHeight=$(document).height();var windowHeight=$(window).height();tools.actScroll(docHeight-windowHeight,2000)}else{tools.actScroll(0,2000)}}}})};this.endLoading=function(){$('body').css('overflow','auto');pageLoading.spinner.setComplete();$('#loading').fadeOut(300);$('a[name="top"]').fadeOut(300)};this.htmlTitle=function(){var RelTitle=document.title,hidden,visibilityChange,timer;if(typeof document.hidden!=="undefined"){hidden="hidden";visibilityChange="visibilitychange"}else if(typeof document.mozHidden!=="undefined"){hidden="mozHidden";visibilityChange="mozvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){hidden="webkitHidden";visibilityChange="webkitvisibilitychange"}function handleVisibilityChange(){if(timer)clearTimeout(timer);if(document[hidden]){timer=setTimeout(function(){document.title=window.cnblogsConfig.webpageTitleOnblur+' - '+RelTitle.split(' - ')[0]},window.cnblogsConfig.webpageTitleOnblurTimeOut)}else{document.title=window.cnblogsConfig.webpageTitleFocus;timer=setTimeout(function(){document.title=RelTitle},window.cnblogsConfig.webpageTitleFocusTimeOut)}}if(typeof document.addEventListener!=="undefined"||typeof document[hidden]!=="undefined"){document.addEventListener(visibilityChange,handleVisibilityChange,false)}};this.setDomHomePosition=function(){$('#home').css('margin-top',$('.main-header').outerHeight()+'px')};this.setPageAnimationControl=function(){if(window.cnblogsConfig.homeTopAnimationRendered||window.cnblogsConfig.essayTopAnimationRendered||window.cnblogsConfig.bgAnimationRendered){var html='<div id="pageAnimationOffOn" data="off" style="z-index:  999;position:  absolute;top: 15px;right: 20px;font-size: 14px;color: #f9f9f9;cursor: pointer;">';html+='<span id="pageAnimationOffOnIcon" class="iconfont icon-shandian" style="display: inline-block;"></span>';html+='<span id="pageAnimationOffOnText">关闭页面特效</span>';html+='</div>';$('body').prepend(html);$('#pageAnimationOffOn').click(function(){if($(this).attr('data')=='off'){$('body').find('canvas').hide();$('#pageAnimationOffOnIcon').rotate({animateTo:-360});$('#pageAnimationOffOnText').text("打开页面特效");$(this).attr('data','on')}else{$('body').find('canvas').show();$('#pageAnimationOffOnIcon').rotate({animateTo:360});$('#pageAnimationOffOnText').text("关闭页面特效");$(this).attr('data','off')}})}};this.setMenuData=function(){var introduceHtml=$('#profile_block').html(),calendar=$('#blog-calendar'),calendarTable=$('#blogCalendar'),sidebarSearch=$('#sidebar_search_box'),scorerank=$('#sidebar_scorerank ul li'),sidebar=$('#sidebar_recentposts ul li'),toptags=$('#sidebar_toptags ul li'),sbClassify=$('#sidebar_postcategory ul li'),sbRecord=$('#sidebar_postarchive ul li'),sbArticle=$('#sidebar_articlearchive ul li'),sbTopview=$('#TopViewPostsBlock ul li'),topDiggPosts=$('#TopDiggPostsBlock ul li'),recentComments=$('#sidebar_recentcomments ul'),menuIntroduce=$('#introduce'),menuCalendar=$('#calendar-box'),menuScorerank=$('#sb-sidebarScorerank'),menuSearchBox=$('#sb-sidebarSearchBox'),menuArticle=$('#sb-articlearchive'),menuSidebar=$('#sb-sidebarRecentposts'),menuToptags=$('#sb-toptags'),menuClassify=$('#sb-classify'),menuRecord=$('#sb-record'),menuTopview=$('#sb-topview'),menuTopDiggPosts=$('#sb-topDiggPosts'),menuRecentComments=$('#sb-recentComments');function setIntroduce(){if((typeof introduceHtml=='string')&&menuIntroduce.html()===''){menuIntroduce.html(tools.htmlFiltrationScript(introduceHtml));bndongJs.clearIntervalTimeId(timeIds.setMenuIntroduceTId)}}function setCalendar(){if(calendarTable.length>0&&menuCalendar.html()===''){var calendarHtml='<div id="blog-calendar">'+calendar.html()+'</div>';calendar.remove();menuCalendar.html(calendarHtml);$('#blog-calendar').css('visibility','visible');bndongJs.clearIntervalTimeId(timeIds.setMenuCalendarTId)}}function setSidebarSearch(){if(sidebarSearch.length>0&&menuSearchBox.html()===''){menuSearchBox.html('<div id="sb_widget_my_zzk" class="div_my_zzk"><input id="q" type="text" onkeydown="return zzk_go_enter(event);" class="input_my_zzk"></div>').prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setSidebarSearchTId)}}function setSidebarScorerank(){if(scorerank.length>0&&menuScorerank.html()===''){menuScorerank.html(getMenuData(scorerank,'icon-collection_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setSidebarScorerankTId)}}function setSidebar(){if(sidebar.length>0&&menuSidebar.html()===''){menuSidebar.html(getMenuData(sidebar,'icon-time_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuSidebarTId)}}function setToptags(){if(toptags.length>0&&menuToptags.html()===''){menuToptags.html(getMenuData(toptags,'icon-label_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuToptagsTId)}}function setClassify(){if(sbClassify.length>0&&menuClassify.html()===''){menuClassify.html(getMenuData(sbClassify,'icon-marketing_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuClassifyTId)}}function setRecord(){if(sbRecord.length>0&&menuRecord.html()===''){menuRecord.html(getMenuData(sbRecord,'icon-task_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuRecordTId)}}function setArticle(){if(sbArticle.length>0&&menuArticle.html()===''){menuArticle.html(getMenuData(sbArticle,'icon-document_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuArticleTId)}}function setTopview(){if(sbTopview.length>0&&menuTopview.html()===''){menuTopview.html(getMenuData(sbTopview,'icon-browse_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuTopviewTId)}}function setTopDiggPosts(){if(topDiggPosts.length>0&&menuTopDiggPosts.html()===''){menuTopDiggPosts.html(getMenuData(topDiggPosts,'icon-like_fill')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuTopDiggPostsTId)}}function setRecentComments(){if(recentComments.length>0&&menuRecentComments.html()===''){menuRecentComments.html(getMenuCommentsData(recentComments,'icon-pinglunzu')).prev('.m-list-title').show();bndongJs.clearIntervalTimeId(timeIds.setMenuRecentCommentsTId)}}function setCustomData(){var customData=window.cnblogsConfig.menuCustomList;if(Object.keys(customData).length>0){$.each(customData,function(title,list){var html='<div class="m-list-title" style="display: block;"><span>'+title+'</span></div>';html+='<div class="m-icon-list"><div><ul>';$.each(list.data,function(key,val){html+='<li><a href="'+val[1]+'">';html+='<span class="iconfont '+list.icon+'" style="color: #888;font-size: 14px;margin-right: 5px;"></span>';html+=val[0]+'</a></li>'});html+='</ul></div></div>';$('#menuCustomList').append(html)})}}function getMenuData(obj,icon){var html='<div><ul>',ret=/^[1-9]+[0-9]*$/;obj.each(function(i){var p=$(obj[i]),o=p.text()===p.html()?{}:$(p.html()),textArr=$.trim(p.text()).split('.');if(ret.test(textArr[0]))textArr.splice(0,1);var text=$.trim(textArr.join('.')),iconHtml='<span class="iconfont '+icon+'" style="color: #888;font-size: 14px;margin-right: 5px;"></span>';o.length>0&&o.html(iconHtml+text);html+='<li>'+(o.length>0?o.prop("outerHTML"):"<a href='javascript:void(0);'>"+iconHtml+text+"</a>")+'</li>'});html+='</ul></div>';return html}function getMenuCommentsData(obj,icon){var html='<div><ul>',ret=/^[1-9]+[0-9]*$/,title,body,author;if(obj.find('li').length>2){title=obj.find('li.recent_comment_title');body=obj.find('li.recent_comment_body');author=obj.find('li.recent_comment_author');if(title.length!==body.length||title.length!==author.length)return;title.each(function(i){var p=$(title[i]),o=p.text()===p.html()?{}:$(p.html()),textArr=$.trim(p.text()).split('.');if(ret.test(textArr[0]))textArr.splice(0,1);var text=$.trim(textArr.join('.')),iconHtml='<span class="iconfont '+icon+'" style="color: #888;font-size: 15px;margin-right: 5px;"></span>';o.length>0&&o.html(iconHtml+text);html+='<li>'+(o.length>0?o.prop("outerHTML"):"<a href='javascript:void(0);'>"+iconHtml+text+"</a>")+'<div style="padding-left: 1.5em;color: #777;position: relative;top: -5px;">'+$(body[i]).text()+'</div><div style="text-align: right;color: #444;position: relative;top: -10px;">'+$(author[i]).text()+'</div></li>'})}html+='</ul></div>';return html}return{setIntroduce:setIntroduce,setCalendar:setCalendar,setSidebarSearch:setSidebarSearch,setSidebarScorerank:setSidebarScorerank,setSidebar:setSidebar,setToptags:setToptags,setClassify:setClassify,setArticle:setArticle,setRecord:setRecord,setTopview:setTopview,setTopDiggPosts:setTopDiggPosts,setCustomData:setCustomData,setRecentComments:setRecentComments}};this.setMenuUserInfoImg=function(){if(window.cnblogsConfig.menuUserInfoBgImg){$('.introduce-box').css({'background':'#000 url('+window.cnblogsConfig.menuUserInfoBgImg+') center no-repeat','background-size':'100%'})}};this.addFooter=function(){const footer=$('#footer'),lHref='https://github.com/'+window.cnblogsConfig.GhUserName+'/'+window.cnblogsConfig.GhRepositories+'/tree/'+window.cnblogsConfig.CnVersions,rHref='https://github.com/'+window.cnblogsConfig.GhUserName+'/'+window.cnblogsConfig.GhRepositories+'/tree/'+window.cnblogsConfig.GhVersions;var pvHtml='',bgFooter='';if(window.cnblogsConfig.bottomText.left||window.cnblogsConfig.bottomText.right)pvHtml+='<div>【'+window.cnblogsConfig.bottomText.left+'<span id="footerTextIcon">'+window.cnblogsConfig.bottomText.icon+'</span>'+window.cnblogsConfig.bottomText.right+'】</div>';pvHtml+="<div><span id='blogRunTimeSpan'></span><span class='my-face'>ღゝ◡╹)ノ♡</span></div>"+'<div id="blogrollInfo"></div><div id="cnzzInfo"></div><div id="themeInfo"></div>';switch(parseInt(window.cnblogsConfig.footerStyle)){case 1:init_t1();break;case 2:default:init_t2();break}setBlogroll();setTheme();window.setInterval(setRunTime,500);timeIds.setCnzzTId=window.setInterval(setCnzz,1000);function init_t1(){pvHtml='<div class="footer-image"></div>'+pvHtml;addFooterHtml();$('#footer').css({'min-height':'130px','_height':'15px','position':'absolute','margin':'200px 0 0 0','left':'0','right':'0','background':'#232323','padding':'17px 0 27px','text-align':'center','color':'#888','font-size':'12px','line-height':'1.5',});$('.footer-image').css({'background':'url(https://images.cnblogs.com/cnblogs_com/kensporger/1639798/o_200131101341footer.png) no-repeat 50%','height':'368px','z-index':'1','position':'absolute','bottom':'100px','width':'100%','pointer-events':'none'})}function init_t2(){bgFooter='<footer><footer-background><figure class="clouds"></figure><figure class="background"></figure><figure class="foreground"></figure><figure class="poof"></figure></footer-background></footer>';addFooterHtml()}function addFooterHtml(){const poweredby=$('#poweredby');bgFooter&&footer.prepend(bgFooter);if(poweredby.length>0){poweredby.before(pvHtml)}else{footer.append(pvHtml)}}function setRunTime(){var runDate=tools.getRunDate(window.cnblogsConfig.blogStartDate?window.cnblogsConfig.blogStartDate:'2019-01-01');$('#blogRunTimeSpan').text('This blog has running : '+runDate.daysold+' d '+runDate.hrsold+' h '+runDate.minsold+' m '+runDate.seconds+' s')}function setBlogroll(){if(window.cnblogsConfig.bottomBlogroll.length>0){var blogrollArr=window.cnblogsConfig.bottomBlogroll;var blogrollHtml='友情链接：';for(var i=0;i<blogrollArr.length;i++){blogrollHtml+='<a href="'+(blogrollArr[i][1])+'" target="_blank">'+(blogrollArr[i][0])+'</a>';if(i<blogrollArr.length-1)blogrollHtml+='<span style="margin: 0 3px;">/</span>'}$('#blogrollInfo').html(blogrollHtml)}}function setCnzz(){var cnzzStat=$('.id_cnzz_stat_icon a');if(cnzzStat.length>0){var cnzzInfo=[];var cnzzArr=$(cnzzStat[1]).text().split('|');$.each(cnzzArr,function(i){var str=$.trim(cnzzArr[i]);if(str!=''){str=str.replace('今日','Today').replace('昨日','Yesterday').replace('[',':').replace(']','');cnzzInfo.push(str)}});cnzzInfo.push($(cnzzStat[2]).text().replace('当前在线','Online').replace('[',':').replace(']',''));$('#cnzzInfo').text(cnzzInfo.join(' | '));bndongJs.clearIntervalTimeId(timeIds.setCnzzTId)}}function setTheme(){$('#themeInfo').html('Theme version: <a href="'+lHref+'" target="_blank" style="color: #888;text-decoration: underline;">'+(window.cnblogsConfig.CnVersions).substring(0,7)+'</a> / Loading theme version: <a href="'+rHref+'" target="_blank" style="color: #888;text-decoration: underline;">'+(window.cnblogsConfig.GhVersions).substring(0,7)+'</a>')}};this.homeInit=function(){myajax({method:'GET',url:"https://www.cnblogs.com/kensporger/gallery/"+window.cnblogsConfig.albumAddress+".html",success:function(htmldata){patt1=/t_.+\.(jpg|jpeg|bmp|png)/g;photosMatch=htmldata.match(patt1);for(i=0;i<photosMatch.length;i++){window.cnblogsConfig.homeTopImg.push("https://images.cnblogs.com/cnblogs_com/kensporger/"+window.cnblogsConfig.albumAddress+"/"+photosMatch[i].replace("t_","o_"))}let homeTopImg=window.cnblogsConfig.homeTopImg,bgImg;homeTopImg.length>0?(homeTopImg.length>1?bgImg=homeTopImg[tools.randomNum(0,homeTopImg.length-1)]:bgImg=homeTopImg[0]):bgImg="";$('.main-header').css({'background':'#222 url('+bgImg+')  center center no-repeat','background-size':'cover'})}});$('.scroll-down').click(function(){let endScroll;endScroll=$('#home').offset().top+10;tools.actScroll(endScroll,1000)});timeIds.setHomeRightMenuTId=window.setInterval(bndongJs.addHomeRightMenu,1000);bndongJs.setHitokoto();bndongJs.scrollMonitor();bndongJs.setDomHomePosition();if(window.cnblogsConfig.homeTopAnimationRendered)require(['circleMagic'],function(){$('.main-header').circleMagic(window.cnblogsConfig.homeTopAnimation)})};this.setHitokoto=function(){var topTitleList=window.cnblogsConfig.homeBannerText;var listIndex=tools.randomNum(0,topTitleList.length-1);$('#hitokoto').text(topTitleList[listIndex]).css('display','-webkit-box');bndongJs.setDomHomePosition()};this.addHomeRightMenu=function(){const rightMenu=$('#rightMenu');if(rightMenu.length>0){var upDownHtml='<div id="toUpDown" data="up"><span class="rightMenuSpan toUpDownSpan">返回顶部</span><div id="toUpDownI"><i class="iconfont icon-zhiding"></i></div></div>';rightMenu.prepend(upDownHtml);bndongJs.rightMenuMous('#toUpDown','.toUpDownSpan');var clickStr=$('#p_b_follow').text()!==''?$('#p_b_follow a').attr('onclick'):'';var attHtml='';if(!clickStr||clickStr.indexOf('unfollow')>0){attHtml='<div id="attention" clickflg="true"><span class="rightMenuSpan attentionSpan">已关注</span><i class="iconfont icon-dianzan1"></i></div>'}else{attHtml='<div id="attention" onclick="'+clickStr.replace('unfollow','follow')+'" clickflg="false"><span class="rightMenuSpan attentionSpan">关注</span><i class="iconfont icon-dianzan"></i></div>'}rightMenu.prepend(attHtml);bndongJs.rightMenuMous('#attention','.attentionSpan');bndongJs.scrollMonitor();bndongJs.clearIntervalTimeId(timeIds.setHomeRightMenuTId)}};this.notHomeInit=function(){const sbTitle=$('#cb_post_title_url').text();$('#sbTitle').text(sbTitle);$('.inner').css('max-width','100vw');bndongJs.setArticleInfoAuthor();timeIds.blogPostCategoryTId=window.setInterval(bndongJs.setArticleInfoClass,1000);timeIds.entryTagTId=window.setInterval(bndongJs.setArticleInfoTag,1000);if($('#bookListFlg').length>0)bndongJs.setBookList();bndongJs.setDomHomePosition();bndongJs.setNotHomeTopImg();bndongJs.setCodeHighlighting();bndongJs.baguetteBox();timeIds.setNotHomeRightMenuTId=window.setInterval(bndongJs.addNotHomeRightMenu,1000);bndongJs.setCommentStyle()};this.setArticleInfoAuthor=function(){const date=$('#post-date').text();var articleAuthor=$('#articleAuthor').val();var author='';if(articleAuthor!=undefined){author=articleAuthor}else{author=window.cnblogsConfig.blogUser}var str='Posted by '+author+' on '+date;$('#articleInfo').append('<p class="article-info-text">'+str+'</p>')};this.setArticleInfoClass=function(){var obj=$('#BlogPostCategory').find('a');if(obj.length>0){$.each(obj,function(i){var tag=$(obj[i]);$('#articleInfo').append('<span class="article-info-tag article-tag-class-color">'+(tag.text())+'</span>')});bndongJs.clearIntervalTimeId(timeIds.blogPostCategoryTId)}};this.setArticleInfoTag=function(){var obj=$('#EntryTag').find('a');if(obj.length>0){$.each(obj,function(i){var tag=$(obj[i]);$('#articleInfo').append('<span class="article-info-tag article-tag-color">'+(tag.text())+'</span>')});bndongJs.clearIntervalTimeId(timeIds.entryTagTId)}};this.initCatalog=function(){const sideToolbar=$('#sideToolbar');if(sideToolbar.length>0){const sideToolbarTop=$('.main-header').outerHeight();sideToolbar.css('top',(sideToolbarTop+20)+'px');bndongJs.resizeMonitor();sideToolbar.fadeIn(300);bndongJs.clearIntervalTimeId(timeIds.setCatalogTId)}};this.setNotHomeTopImg=function(){var essayTopImg=window.cnblogsConfig.essayTopImg,bgImg;essayTopImg.length>0?(essayTopImg.length>1?bgImg=essayTopImg[tools.randomNum(0,essayTopImg.length-1)]:bgImg=essayTopImg[0]):bgImg="";$('.main-header').css({'height':'40vh','background':'#222 url('+bgImg+')  center center no-repeat','background-size':'cover'});$('#homeTopTitle').hide();$('.scroll-down').hide();$('#home').css('margin-top','40vh');$('#cb_post_title_url').addClass('post-del-title');if(window.cnblogsConfig.essayTopAnimationRendered)require(['TweenMax_MyTween'],function(){$('#notHomeTopCanvas').css({'margin':'auto','width':'100%','height':'100%','top':'0','bottom':'0','left':'0','right':'0'});initCanvas('notHomeTopCanvas');start()})};this.baguetteBox=function(){require(['baguetteBox','title','marvin','articleStatement'],function(baguetteBox){const cpb=$('#cnblogs_post_body'),imgList=$('#cnblogs_post_body img');if(cpb.length>0&&imgList.length>0){$.each(imgList,function(i){let tem=$(imgList[i]);let flg=tem.attr('id');if(typeof flg=='undefined'&&tem.outerWidth()>50){tem.wrap("<a class='lightbox' href='"+tem.attr('src')+"'></a>")}});baguetteBox.run('.lightbox')}timeIds.setCatalogTId=window.setInterval(bndongJs.initCatalog,1000);bndongJs.scrollMonitor()})};this.setBookList=function(){if(window.cnblogsConfig.bookList.length>0){var postBody=$('#cnblogs_post_body'),html='';$.each(window.cnblogsConfig.bookList,function(i){var list=window.cnblogsConfig.bookList[i];html+='<h1>'+list.title+'</h1>';$.each(list.books,function(j){var book=list.books[j];html+='<div class="doulist-item"><div class="mod"><div class="hd"></div><div class="bd doulist-subject">    <div class="post"><img width="100" src="'+book.cover+'"></div>    <div class="title">'+book.name+'</div><div class="abstract">'+(book.formerNname?'原名: '+book.formerNname+'<br>':'')+(book.author?'作者: '+book.author+'<br>':'')+(book.translator?'译者: '+book.translator+'<br>':'')+(book.press?'出版社: '+book.press+'<br>':'')+(book.year?'出版年: '+book.year:'')+'</div></div></div></div>'})});postBody.append(html)}};this.setCodeHighlighting=function(){var pre=$('.post pre'),codeSpan=$('.cnblogs_code span'),hltype=window.cnblogsConfig.essayCodeHighlightingType.toLowerCase(),hltheme=window.cnblogsConfig.essayCodeHighlighting.toLowerCase();switch(hltype){case'highlightjs':setCodeBefore();highlightjsCode();break;case'prettify':setCodeBefore();prettifyCode();break;case'cnblogs':default:cnblogsCode();break}setCopyBtn();setScrollbarStyle();function setCopyBtn(){$('.cnblogs_code_toolbar').remove();require(['clipboard'],function(){pre.each(function(i){var obj=$(this),id=tools.randomString(8);obj.wrap('<code-box id="'+id+'" style="position: relative;display: block;"></code-box>');obj.attr('code-id',id);var html='<button code-id="'+id+'" type="button" class="clipboard" data-clipboard-action="copy" data-clipboard-target="pre[code-id='+id+']" aria-label="复制代码" style="    position: absolute;    top: 8px;    right: 23px;    display: flex;    justify-content: center;    align-items: center;    width: 30px;    height: 25px;    cursor: pointer;    font-size: 14px;    padding: 0 0 0 2px;    border: none;    border-radius: 6px;    color: #ccc;    opacity: 0;    visibility: hidden;    background-color: hsla(0,0%,90.2%,.2);    -webkit-user-select: none;    -moz-user-select: none;    -ms-user-select: none;    user-select: none;    transition: opacity .2s ease-in-out,visibility .2s ease-in-out;    z-index: 1;"><i class="iconfont icon-fuzhi1"></i></button>';$('#'+id).prepend(html)});$('code-box button').click(function(){$(this).find('i').removeClass('icon-fuzhi1').addClass('icon-right');setTimeout("$('code-box button[code-id="+$(this).attr('code-id')+"] i').removeClass('icon-right').addClass('icon-fuzhi1')",1500)});$('code-box').on({mouseover:function(){$(this).find('button').css({opacity:1,visibility:'visible'})},mouseout:function(){$(this).find('button').css({opacity:0,visibility:'hidden'})}});new ClipboardJS('.clipboard')})}function cnblogsCode(){codeSpan.css('background-color','#f6f8fa');pre.css({'background-color':'#f6f8fa','overflow-x':'auto'})}function highlightjsCode(){tools.dynamicLoadingCss('https://blog-static.cnblogs.com/files/kensporger/'+hltheme+'.min.css');require(['highlightjs'],function(){$('.post pre').each(function(i,block){if($.inArray(hltheme,['github-gist','googlecode','grayscale','idea','isbl-editor-light','qtcreator_light','tomorrow','vs','xcode','arduino-light','ascetic','color-brewer','lightfair'])!==-1)pre.css('background-color','#f6f8fa');hljs.highlightBlock(block)})})}function prettifyCode(){pre.addClass('prettyprint');switch(hltheme){case'prettify':require(['codePrettify'],function(){$('pre').css('background-color','#f6f8fa').css('border','0')});break;case'desert':require(['codeDesert']);break;case'sunburst':require(['codeSunburst']);break;case'obsidian':require(['codeObsidian']);break;case'doxy':require(['codeDoxy']);break;default:cnblogsCode();break}}function setCodeBefore(){$.each(pre,function(i){var obj=$(this);obj.find('br').after('&#10;');var codetext=obj.text();obj.html('').text(codetext).css('overflow-x','auto')})}function setScrollbarStyle(){tools.dynamicLoadingCss(getJsDelivrUrl('jquery.mCustomScrollbar.css'));var scrollbarTimeId=window.setInterval(function(){if($('.post pre span').length>0){$('.post pre').mCustomScrollbar({theme:"minimal-dark",axis:"yx"});var color;switch(hltype){case'highlightjs':color=$('.hljs-comment').css('color');$('.mCSB_dragger_bar').css('background-color',color);break;case'prettify':color=$('.com').css('color');$('.mCSB_dragger_bar').css('background-color',color);break;case'cnblogs':color="rgb(153, 153, 153)";break}$('code-box button').css('color',color);bndongJs.clearIntervalTimeId(scrollbarTimeId)}},500)}};this.setCommentStyle=function(){var commentList=$('.blog_comment_body'),commentPlaceholder=$('#blog-comments-placeholder');commentAvatar(commentList);commentList.addClass('hvr-bob');timeIds.commentTId=window.setInterval(function(){if(commentPlaceholder.html()!=''||$("#comments_pager_bottom").length>0){CommentBubble();bndongJs.clearIntervalTimeId(timeIds.commentTId)}},1000);function commentAvatar(commentList){commentList.each(function(i){var p=$(commentList[i]).attr('id').split('_'),html='';if(p.length>0){var idIndex=p.length-1;var id=p[idIndex];var idTmp=id.toString().match(/[0-9]/g);if($.isArray(idTmp))id=idTmp.join('');var op=$('#comment_'+id+'_avatar');if(op.length>0&&op.text()!=''){var patch=op.text();html+='<img class="comment-avatar" src="'+patch+'"/>'}else{html+='<img class="comment-avatar" src="https://images.cnblogs.com/cnblogs_com/kensporger/1639798/o_200131101838default_avatar.jpeg"/>'}$(commentList[i]).before(html)}})}function CommentBubble(){var w1='<div class="list"><table class="out" border="0" cellspacing="0" cellpadding="0"> <tr><td align="left" valign="bottom" class="q"><table border="0" cellpadding="0" cellspacing="0" style=""> <tr><td class="topleft"></td><td class="top"></td><td class="topright"></td></tr> <tr><td class="left"></td> <td align="left" class="conmts"><p>';var w2='</p> </td> <td class="right"></td></tr> <tr><td class="bottomleft"></td><td class="bottom"></td><td class="bottomright"></td></tr> </table></td> </tr> </table> </div>';$.each($(".blog_comment_body"),function(i,t){$(t).html(w1+$(t).html()+w2)});$(".louzhu").closest(".feedbackItem").find(".out").removeClass("out").addClass("inc")}};this.addNotHomeRightMenu=function(){var rightMenu=$('#rightMenu');if(rightMenu.length>0&&$('#div_digg').length>0){if($('#toUpDown').length==0&&$('#attention').length==0)bndongJs.addHomeRightMenu();var rightBuryitHtml='<div id="rightBuryit" clickflg="false" onclick="'+($(".buryit").attr("onclick"))+'"><span class="rightMenuSpan rightBuryitSpan">'+$('#bury_count').text()+'</span><i class="iconfont icon-buzan"></i></div>';rightMenu.prepend(rightBuryitHtml);bndongJs.rightMenuMous('#rightBuryit','.rightBuryitSpan');var rightDiggitHtml='<div id="rightDiggit" clickflg="false" onclick="'+($(".diggit").attr("onclick"))+'"><span class="rightMenuSpan rightDiggitSpan">'+$('#digg_count').text()+'</span><i class="iconfont icon-zan1"></i></div>';rightMenu.prepend(rightDiggitHtml);bndongJs.rightMenuMous('#rightDiggit','.rightDiggitSpan');bndongJs.clearIntervalTimeId(timeIds.setNotHomeRightMenuTId)}}}function myajax(opt){opt=opt||{};opt.method=opt.method.toUpperCase()||'POST';opt.url=opt.url||'';opt.async=true;opt.data=opt.data||null;opt.success=opt.success||function(){};var xmlHttp=null;if(XMLHttpRequest){xmlHttp=new XMLHttpRequest()}else{xmlHttp=new ActiveXObject('Microsoft.XMLHTTP')}var params=[];for(var key in opt.data){params.push(key+'='+opt.data[key])}var postData=params.join('&');if(opt.method.toUpperCase()==='POST'){xmlHttp.open(opt.method,opt.url,opt.async);xmlHttp.setRequestHeader('Content-Type','application/x-www-form-urlencoded;charset=utf-8');xmlHttp.send(postData)}else if(opt.method.toUpperCase()==='GET'){xmlHttp.open(opt.method,opt.url+'?'+postData,opt.async);xmlHttp.send(null)}xmlHttp.onreadystatechange=function(){if(xmlHttp.readyState==4&&xmlHttp.status==200){opt.success(xmlHttp.responseText)}}}